% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/slurm_job.R
\name{run_slurm_job}
\alias{run_slurm_job}
\title{Submit a SLURM job with completion tracking}
\usage{
run_slurm_job(
  name,
  command,
  working_dir,
  completion_files,
  slurm_options = list(),
  modules_to_load = NULL,
  env_vars = NULL,
  force_resubmit = FALSE
)
}
\arguments{
\item{name}{Character. Job name used for script filename and SLURM job name.}

\item{command}{Character. The shell command to execute.}

\item{working_dir}{Character. Directory for script creation and job execution.}

\item{completion_files}{Character vector. Relative paths from working_dir
that indicate successful completion. First found file is returned.}

\item{slurm_options}{Named list. SLURM parameters:
\itemize{
\item time: Wall time (e.g., "24:00:00")
\item mem: Total memory (e.g., "64G")
\item cpus_per_task: Number of CPUs (integer)
\item partition: SLURM partition (default from cluster)
\item gres: Generic resources (e.g., "gpu:1")
\item Additional options passed as --name=value
}}

\item{modules_to_load}{Character vector. Modules to load (e.g., "singularity").}

\item{env_vars}{Named list. Environment variables to export.}

\item{force_resubmit}{Logical. If TRUE, resubmit even if script exists.}
}
\value{
Path to completion file (if exists) or script path.
}
\description{
Submits a shell command as a SLURM job and tracks completion via output files.
Implements a "fire and track" pattern for targets integration:
\enumerate{
\item Check if completion files exist (job already done) -> return completion path
\item Check if script exists (job already submitted) -> return script path
\item Otherwise, create script and submit via sbatch -> return script path
}
}
\details{
Use with \code{tar_cue(mode = "always")} and \code{deployment = "main"} in targets.
}
\examples{
\dontrun{
# In _targets.R
tar_target(
  my_job,
  run_slurm_job(
    name = "my_analysis",
    command = "python script.py --input data.csv",
    working_dir = "/scratch/user/analysis",
    completion_files = "results/output.csv",
    slurm_options = list(time = "4:00:00", mem = "32G", cpus_per_task = 4L),
    modules_to_load = "python/3.10"
  ),
  cue = tar_cue(mode = "always"),
  deployment = "main"
)
}
}
